<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Custom Replay</title>

<style>
:root{
  --bg:#0b0f17;
  --panel:#111827;
  --muted:#94a3b8;
  --text:#e5e7eb;
  --accent:#60a5fa;
  --border:rgba(148,163,184,.18);
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
  background:radial-gradient(1200px 700px at 15% 10%, rgba(96,165,250,.18), transparent 55%),var(--bg);
  color:var(--text);
}
.hidden{display:none!important}

.wrap{max-width:1200px;margin:auto;padding:20px}
header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
h1{margin:0;font-size:18px}
.tag{font-size:12px;color:var(--muted);border:1px solid var(--border);padding:6px 10px;border-radius:999px}

.grid{display:grid;grid-template-columns:420px 1fr;gap:14px}

/* PLAYER MODE LAYOUT */
body.player-mode .grid{
  grid-template-columns:1fr;
}
body.player-mode .playerWrap,
body.player-mode .playerBox,
body.player-mode .chapters{
  max-width:960px;
  margin:auto;
}

.card{
  background:rgba(17,24,39,.85);
  border:1px solid var(--border);
  border-radius:16px;
  padding:14px;
}

.label{font-size:12px;color:var(--muted);margin:10px 0 6px}
input,textarea{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:1px solid var(--border);
  background:rgba(2,6,23,.4);
  color:var(--text);
}
textarea{resize:vertical}

.btns{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
button{
  padding:8px 12px;
  border-radius:10px;
  border:1px solid var(--border);
  background:rgba(2,6,23,.4);
  color:var(--text);
  font-weight:600;
  cursor:pointer;
}
button.primary{background:rgba(96,165,250,.2)}

.playerBox{
  aspect-ratio:16/9;
  border-radius:16px;
  overflow:hidden;
  border:1px solid var(--border);
}
#player{width:100%;height:100%}

.controls{display:flex;gap:8px;margin-top:10px;flex-wrap:wrap}

.chapters{margin-top:14px;display:grid;gap:8px}
.chapter{
  padding:10px;
  border-radius:12px;
  border:1px solid var(--border);
  cursor:pointer;
}
.chapter.active{
  background:rgba(96,165,250,.2);
}

/* Overlay */
.overlay{
  position:fixed;
  inset:0;
  background:rgba(2,6,23,.75);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:9999;
}
.overlay.show{display:flex}
.overlayCard{
  max-width:600px;
  background:rgba(17,24,39,.95);
  padding:20px;
  border-radius:18px;
  border:1px solid var(--border);
}
</style>
</head>

<body>
<div class="wrap">
<header>
  <div>
    <h1>Custom Replay</h1>
    <div class="tag" id="modeTag">Coach mode</div>
  </div>
  <div class="tag">N next · P prev · Space play</div>
</header>

<div class="grid">

<!-- BUILDER -->
<div class="card" id="builder">
  <div class="label">YouTube URL</div>
  <input id="yt">

  <div class="label">Title</div>
  <input id="title">

  <div class="label">Instruction</div>
  <textarea id="note"></textarea>

  <div class="label">Start</div>
  <input id="start">

  <div class="label">End</div>
  <input id="end">

  <div class="btns">
    <button id="add" class="primary">Add segment</button>
  </div>

  <!-- MARK PANEL -->
  <div class="label">Mark from video</div>
  <div class="btns">
    <button id="back">-2s</button>
    <button id="fwd">+2s</button>
    <button id="markStart" class="primary">Set Start</button>
    <button id="markEnd" class="primary">Set End</button>
  </div>
</div>

<!-- PLAYER -->
<div class="card playerWrap">
  <div class="playerBox"><div id="player"></div></div>

  <div class="controls">
    <button id="prev">Prev</button>
    <button id="play">Play</button>
    <button id="pause">Pause</button>
    <button id="next">Next</button>
  </div>

  <div class="chapters" id="chapters"></div>
</div>

</div>
</div>

<!-- OVERLAY -->
<div class="overlay" id="overlay">
  <div class="overlayCard">
    <h2 id="oTitle"></h2>
    <p id="oText"></p>
    <div class="btns">
      <button id="oPlay" class="primary">Play clip</button>
    </div>
  </div>
</div>

<script src="https://www.youtube.com/iframe_api"></script>
<script>
let player,segments=[],idx=0,mode="coach";
const $=id=>document.getElementById(id);

function toMMSS(s){
  s=Math.round(s);
  const m=Math.floor(s/60),sec=s%60;
  return `${m}:${String(sec).padStart(2,"0")}`;
}

function applyMode(){
  document.body.classList.toggle("player-mode",mode==="player");
  $("builder").classList.toggle("hidden",mode==="player");
  $("modeTag").textContent=mode==="player"?"Player mode":"Coach mode";
}

window.onYouTubeIframeAPIReady=()=>{
  player=new YT.Player("player",{events:{onReady:()=>{}}});
};

$("markStart").onclick=()=>{$("start").value=toMMSS(player.getCurrentTime())}
$("markEnd").onclick=()=>{$("end").value=toMMSS(player.getCurrentTime())}
$("back").onclick=()=>player.seekTo(Math.max(0,player.getCurrentTime()-2),true)
$("fwd").onclick=()=>player.seekTo(player.getCurrentTime()+2,true)

$("add").onclick=()=>{
  const s=parseInt($("start").value.split(":")[0])*60+parseInt($("start").value.split(":")[1]);
  const e=parseInt($("end").value.split(":")[0])*60+parseInt($("end").value.split(":")[1]);
  segments.push({title:$("title").value,note:$("note").value,start:s,end:e});
  render();
};

function render(){
  $("chapters").innerHTML="";
  segments.forEach((seg,i)=>{
    const d=document.createElement("div");
    d.className="chapter"+(i===idx?" active":"");
    d.innerHTML=`${seg.title}<br><small>${toMMSS(seg.start)}–${toMMSS(seg.end)}</small>`;
    d.onclick=()=>show(i);
    $("chapters").appendChild(d);
  });
}

function show(i){
  idx=i;
  $("oTitle").textContent=segments[i].title;
  $("oText").textContent=segments[i].note;
  $("overlay").classList.add("show");
}

$("oPlay").onclick=()=>{
  $("overlay").classList.remove("show");
  const s=segments[idx];
  player.seekTo(s.start,true);
  player.playVideo();
};

$("play").onclick=()=>player.playVideo();
$("pause").onclick=()=>player.pauseVideo();
$("next").onclick=()=>idx<segments.length-1&&show(idx+1);
$("prev").onclick=()=>idx>0&&show(idx-1);

applyMode();
</script>
</body>
</html>
